s3 buckets availability check list
--

#!/bin/bash

# File containing the list of S3 bucket names
BUCKET_LIST_FILE="buckets.txt"

# Initialize the count
count=0

# Read each bucket name from the file
while IFS= read -r bucket; do
  # Check if the bucket exists
  if aws s3api head-bucket --bucket "$bucket" 2>/dev/null; then
    echo "Bucket exists: $bucket"
    count=$((count + 1))
  else
    echo "Bucket does not exist: $bucket"
  fi
done < "$BUCKET_LIST_FILE"

# Print the total count of existing buckets
echo "Total existing buckets: $count"


---
#!/bin/bash

# Check if bucket name is provided
if [ -z "$1" ]; then
  echo "Usage: $0 <bucket-name>"
  exit 1
fi

BUCKET_NAME=$1

# Create lifecycle policy JSON
LIFECYCLE_POLICY='{
    "Rules": [
        {
            "ID": "Immediate deletion of all objects",
            "Filter": {
                "Prefix": ""
            },
            "Status": "Enabled",
            "Expiration": {
                "Days": 1
            },
            "NoncurrentVersionExpiration": {
                "NoncurrentDays": 1
            },
            "AbortIncompleteMultipartUpload": {
                "DaysAfterInitiation": 1
            }
        }
    ]
}'

# Apply the lifecycle policy to the bucket
aws s3api put-bucket-lifecycle-configuration --bucket "$BUCKET_NAME" --lifecycle-configuration "$LIFECYCLE_POLICY"

if [ $? -eq 0 ]; then
  echo "Lifecycle policy created for bucket: $BUCKET_NAME"
else
  echo "Failed to create lifecycle policy for bucket: $BUCKET_NAME"
fi
